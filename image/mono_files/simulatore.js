!function(){var t=window.Vue;t.component("grafico-widget",{template:'\n        \t\t<div class="mutuoGraficoChart">\n\t\t\t\t\t<canvas  v-bind:id="id"></canvas> \n\t\t\t\t</div>\n        ',name:"grafico-widget",chart:null,props:{id:{type:String,default:"mutuoChart"},dataset:{type:Array,default:[]}},data:function(){return{labels:this.mapKeyToArray("label"),values:this.mapKeyToArray("value"),fills:this.mapKeyToArray("fill")}},watch:{dataset:function(){this.labels=this.mapKeyToArray("label"),this.fills=this.mapKeyToArray("fill"),this.values=this.mapKeyToArray("value"),this.renderWidget()}},methods:{mapKeyToArray:function(t){var a=[];for(let o=0;o<this.dataset.length;o++){const e=this.dataset[o];a.push(e[t])}return a},renderWidget:function(){var t=document.getElementById(this.id).getContext("2d");void 0!=this.chart&&this.chart.destroy(),this.chart=new Chart(t,{type:"doughnut",data:{labels:this.labels,datasets:[{data:this.values,backgroundColor:this.fills}]},options:{cutoutPercentage:60,legend:{display:!1}}})}}}),t.component("calcola-mutuo",{template:'        \n                    <div class="calcoloMutuo">\n                    \x3c!-- CUSTOM HEADER --\x3e\n                        <slot name="header"></slot>\n                        \x3c!-- INFO TMM --\x3e\n                        <div class="row margin-top20" v-show="tassoBase>0">\n                            <div class="col-sm-12 text-right">\n                                <b>{{getLabel(\'tasso\')}}</b>: {{tassoBase}} %                            \n                            </div>\n                        </div>\n                        \x3c!-- FORM --\x3e\n                        <div class="row margin-top20">\n                            <div class="col-md-7 col-sm-7">\n                                <div class="form-horizontal">\n                                    \x3c!-- TIPO UTENTE --\x3e\n                                    <div class="form-group" v-show=\'optionsTipoUtente.length > 0\'>\n                                        <label for="mutuoDurata" class="col-md-5 control-label">{{ getLabel(\'tipoUtente\') }}\n                                        </label>\n                                        <div class="col-md-7">\n                                            <select class="selectpicker form-control" v-model="tipoUtenteValue" v-on:change="aggiornaTipoUtente">\n                                                <option v-for="option in optionsTipoUtente" v-bind:value="option.value">\n                                                    {{ option.label }}\n                                                </option>\t\t\t\t\t\t\t\n                                            </select>\n                                        </div>\n                                    </div>     \n                                    \x3c!-- PREZZO IMMOBILE --\x3e                              \n                                    <div class="form-group">\n                                        <label for="immobilePrezzo" class="col-md-5 control-label">{{ getLabel(\'prezzo\') }}</label>\n                                        <div class="col-md-7">\n                                            <div class="input-group">\n                                                <input type="text" class="form-control" v-model="prezzoImmobileValue" v-on:keyup="aggiorna" disabled>\n                                                <span class="input-group-addon" id="calcoloMutuoValue1">{{getLabel(\'valuta\')}}</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    \x3c!-- IMPORTO MUTUO --\x3e\n                                    <div class="form-group">\n                                        <label for="mutuoImporto" class="col-md-5 control-label">{{ getLabel(\'mutuo\') }}</label>\n                                        <div class="col-md-7">\n                                            <div class="input-group">\n                                                <input type="text" class="form-control" v-model="importoMutuoValue" v-on:keyup="aggiorna" :max=\'prezzoImmobile\' :disabled="abilitaModificaMutuo!==true">\n                                                <span class="input-group-addon" id="calcoloMutuoValue2">{{getLabel(\'valuta\')}}</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    \x3c!-- DURATA MUTUO --\x3e\n                                    <div class="form-group">\n                                        <label for="mutuoDurata" class="col-md-5 control-label">{{ getLabel(\'durata\') }}<br>\n                                            <span id=\'tassoChange\'></span>\n                                        </label>\n                                        <div class="col-md-7">\n                                            <select class="selectpicker form-control" v-model="durataMutuoValue" v-on:change="aggiornaRata">\n                                                <option v-for="option in optionsDurataMutuo" v-bind:value="option.durata">\n                                                    {{ option.durata }} {{ getLabel(durataTipo) }}\n                                                </option>\t\t\t\t\t\t\t\n                                            </select>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            \x3c!-- GRAFICO --\x3e\n                            <div class="col-md-5 col-sm-5">\n                                <div class="mutuoGrafico">\n                                    <grafico-widget\n                                        id = \'mutuoChart\'\n                                        :dataset=\'dataset\' \n                                        >\n                                    </grafico-widget>\n                                \n                                    <div class="mutuoGraficoLabel">\n                                        <div class="mutuoGraficoLabel20 graficoLabelAnticipo" id="graficoLabelAnticipo">\n                                            <div id="anticipoLabel" class="anticipoLabel">{{getLabel(\'anticipoGrafico\')}}</div>\n                                            <span id="mutuoPrezzAnticipo" class="mutuoPrezzAnticipo">{{anticipo}}</span> {{getLabel(\'valuta\')}} <br> ( <span id="mutuoPercAnticipo" class="mutuoPercAnticipo">{{anticipoPercentuale}}</span>% )\n                                        </div>\n                                        <div class="mutuoGraficoLabel60">\n                                            <div></div>\n                                            <div></div>\n                                        </div>\n                                        <div class="mutuoGraficoLabel20 graficoLabelMutuo" id="graficoLabelMutuo">\n                                            <div id="mutuoLabel" class="mutuoLabel">{{getLabel(\'mutuoGrafico\')}}</div>\n                                            <span id="mutuoPrezz" class="mutuoPrezz">{{importoMutuoValue}}</span>  {{getLabel(\'valuta\')}} <br> ( <span id="mutuoPerc" class="mutuoPerc">{{(100-anticipoPercentuale)}}</span>% )\n                                        </div>\n                                    </div>\n                                </div>\n                                \x3c!-- RATA --\x3e\n                                <div class="rataFormattata"><b>{{getLabel(\'rata\')}}</b>: {{rataFormattata}} {{getLabel(\'valuta\')}}</div>\n                            </div>\n                        </div>\n                        <div class="row" v-show="cta.enabled">\n                            <a :href="ctaLinkFormattato" target="_blank">\n                                <button :class="cta.class"> \n                                    {{cta.label}}\n                                </button>\n                            </a>\n                        </div>\n                        \x3c!-- CUSTOM FOOTER --\x3e          \n                        <slot name="footer"></slot>\n                    </div>\n                    ',props:{abilitaModificaMutuo:{type:Boolean,default:!1},coloreAnticipo:{type:String,default:"#2a3e50"},coloreMutuo:{type:String,default:"#00984b"},cta:{type:Object,default:{anabled:!1,customParams:"",link:"",class:"",label:""}},divisoreMutuo:{type:Number,default:1},durataMutuo:Number,durataTipo:{type:String,default:"anni"},importoMutuo:Number,labels:{type:Object,default:{}},optionsDurataMutuo:Array,optionsTipoUtente:Array,prezzoImmobile:Number,tassoBase:{type:Number,default:0},tipoUtente:{type:Number,default:.8}},data:function(){return{dataset:[],defaultLabels:{anni:"Anni",anticipoGrafico:"Anticipo",durata:"Durata del mutuo",mesi:"Mesi",mutuo:"Importo del mutuo",mutuoGrafico:"Mutuo",prezzo:"Prezzo immobile",rata:"Rata",tasso:"Tasso Base",tipoUtente:"Tipo Utente",valuta:"DT"},durataMutuoValue:this.durataMutuo,importoMutuoValue:this.importoMutuo?this.importoMutuo:this.number_format(this.prezzoImmobile*this.tipoUtente,0,",","."),parametri:["prezzoImmobileValue","durataMutuoValue","importoMutuoValue","tipoUtenteValue"],prezzoImmobileValue:this.number_format(this.prezzoImmobile,0,",","."),rata:0,tasso:0,tipoUtenteValue:this.tipoUtente}},computed:{anticipo:function(){return this.number_format(this.prezzoImmobile-this.formatted_to_number(this.importoMutuoValue),0,",",".")},anticipoPercentuale:function(){var t=100*(this.prezzoImmobile-this.formatted_to_number(this.importoMutuoValue))/this.prezzoImmobile;return Math.floor(t)},ctaLinkFormattato:function(){return this.cta.link+this.mappaParametri()+"&"+this.cta.customParams},rataFormattata:function(){return this.number_format(Math.ceil(this.rata),0,",",".")},prezzoImmobileFormattato:function(){return this.number_format(this.prezzoImmobileValue,0,",",".")}},methods:{aggiorna:function(){this.aggiornaMutuo(),this.aggiornaGrafico(),this.aggiornaRata()},aggiornaMutuo:function(){this.abilitaModificaMutuo&&(this.importoMutuoValue=this.number_format(this.prezzoImmobile*this.tipoUtenteValue,0,",",".")),this.formatted_to_number(this.importoMutuoValue)>this.prezzoImmobile?this.importoMutuoValue=this.number_format(this.prezzoImmobile,0,",","."):this.importoMutuoValue=this.number_format(this.formatted_to_number(this.importoMutuoValue),0,",",".")},aggiornaTipoUtente:function(){this.importoMutuoValue=this.number_format(this.prezzoImmobile*this.tipoUtenteValue,0,",","."),this.aggiorna()},aggiornaGrafico:function(){var t=this.prezzoImmobile,a=this.formatted_to_number(this.importoMutuoValue),o=parseInt(a/t*100),e=100-o;this.dataset=[{value:o,label:this.getLabel("mutuoGrafico"),fill:this.coloreMutuo},{value:e,label:this.getLabel("anticipoGrafico"),fill:this.coloreAnticipo}]},aggiornaRata:function(){nTasso=0;for(var t=0;t<this.optionsDurataMutuo.length;t++)this.optionsDurataMutuo[t].value==this.durataMutuoValue&&(nTasso=this.optionsDurataMutuo[t].tasso);this.tasso=parseFloat(nTasso)+parseFloat(this.tassoBase),this.rata=this.calcolaRata(this.formatted_to_number(this.importoMutuoValue),this.durataMutuoValue/this.divisoreMutuo,this.tasso)},calcolaRata:function(t,a,o){var e,i=o/12/100;return e=t*i/(1-1/Math.pow(1+i,12*a)),parseFloat(e)},getLabel:function(t){return this.labels[t]?this.labels[t]:this.defaultLabels[t]?this.defaultLabels[t]:t},mappaParametri:function(){var t="";for(let a=0;a<this.parametri.length;a++){const o=this.parametri[a];t+=(0==a?"":"&")+o+"="+this[o]}return"?"+t},number_format:function(t,a,o,e){t=(t+"").replace(/[^0-9+\-Ee.]/g,"");var i=isFinite(+t)?+t:0,n=isFinite(+a)?Math.abs(a):0,r=void 0===e?",":e,u=void 0===o?".":o,l="";return(l=(n?function(t,a){var o=Math.pow(10,a);return""+Math.round(t*o)/o}(i,n):""+Math.round(i)).split("."))[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(l[1]||"").length<n&&(l[1]=l[1]||"",l[1]+=new Array(n-l[1].length+1).join("0")),l.join(u)},formatted_to_number:function(t){return"string"==typeof t?parseInt(t.replace(/\./g,"")):t}},mounted:function(){this.aggiorna()}});new t({delimiters:["##","##"],el:"#calcolatore-mutuo"})}();